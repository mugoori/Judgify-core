# Frontend ìë™ ìƒì„± ì „ëµ (Ver2.0 Final)

**ëª©ì **: BI Serviceì™€ Data Visualization Serviceì—ì„œ ì‚¬ìš©í•˜ëŠ” React ì»´í¬ë„ŒíŠ¸ ìë™ ìƒì„± íŒ¨í„´

**ê´€ë ¨ ì„œë¹„ìŠ¤**:
- BI Service (8007): MCP ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ ì¡°ë¦½ + AI ì¸ì‚¬ì´íŠ¸
- Data Visualization Service (8006): ë‹¨ìˆœ ë°ì´í„° ëŒ€ì‹œë³´ë“œ

---

## ğŸ¯ React ì»´í¬ë„ŒíŠ¸ ìë™ ìƒì„±

### ìë™ ìƒì„± ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸

```typescript
// Claudeê°€ ìƒì„±í•´ì•¼ í•˜ëŠ” ìë™ ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸ íŒ¨í„´

export const AutoGeneratedDashboard = ({ config }: DashboardProps) => {
  const { data, loading } = useRealTimeData({
    dataSource: config.dataSource,
    refreshInterval: config.refreshInterval || 30000
  });

  return (
    <div className="dashboard-container">
      <h1 className="text-2xl font-bold mb-6">{config.title}</h1>
      <div className="grid grid-cols-12 gap-4">
        {config.components.map((component, index) => (
          <div
            key={index}
            className={`col-span-${component.width} h-${component.height}`}
          >
            {component.type === 'BarChart' && (
              <BarChart data={data[component.dataKey]} {...component.props} />
            )}
            {component.type === 'MetricCard' && (
              <MetricCard value={data[component.dataKey]} {...component.props} />
            )}
            {component.type === 'LineChart' && (
              <LineChart data={data[component.dataKey]} {...component.props} />
            )}
            {component.type === 'PieChart' && (
              <PieChart data={data[component.dataKey]} {...component.props} />
            )}
            {/* ê¸°íƒ€ ì°¨íŠ¸ íƒ€ì…ë“¤ */}
          </div>
        ))}
      </div>
    </div>
  );
};
```

### ì‹¤ì‹œê°„ ë°ì´í„° í›…

```typescript
// Claudeê°€ êµ¬í˜„í•˜ëŠ” ì‹¤ì‹œê°„ ë°ì´í„° í›…

const useRealTimeData = ({ dataSource, refreshInterval }) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const ws = new WebSocket(`ws://localhost:8006/realtime/${dataSource}`);

    ws.onmessage = (event) => {
      setData(JSON.parse(event.data));
      setLoading(false);
    };

    ws.onerror = (error) => {
      console.error('WebSocket error:', error);
      setLoading(false);
    };

    return () => ws.close();
  }, [dataSource]);

  return { data, loading };
};
```

---

## ğŸ§© MCP ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ ì¡°ë¦½ (BI Service)

### ì»´í¬ë„ŒíŠ¸ ì„ íƒ ë¡œì§

```typescript
// LLM ìš”ì²­ â†’ ìµœì  ì°¨íŠ¸ íƒ€ì… ë§¤í•‘

const selectChartComponent = (dataType: string, intent: string): ChartType => {
  const mapping = {
    'timeseries': 'LineChart',
    'categorical': 'BarChart',
    'distribution': 'PieChart',
    'comparison': 'BarChart',
    'trend': 'LineChart',
    'kpi': 'MetricCard',
    'gauge': 'GaugeChart'
  };

  // LLMì´ ë°ì´í„° íƒ€ì…ê³¼ ì˜ë„ë¥¼ ë¶„ì„í•˜ì—¬ ìµœì  ì°¨íŠ¸ ì„ íƒ
  return mapping[dataType] || 'BarChart';
};
```

### ìë™ ëŒ€ì‹œë³´ë“œ ìƒì„± íë¦„

```typescript
// BI Serviceê°€ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹œë³´ë“œ ìë™ ìƒì„± í•¨ìˆ˜

interface DashboardGenerationRequest {
  userRequest: string;           // "ì§€ë‚œ ì£¼ ì›Œí¬í”Œë¡œìš°ë³„ ì„±ê³µë¥  ë³´ì—¬ì¤˜"
  dataSource?: string;            // ë°ì´í„° ì†ŒìŠ¤ (ì„ íƒ)
  refreshInterval?: number;       // ê°±ì‹  ì£¼ê¸° (ì„ íƒ)
}

interface DashboardConfig {
  title: string;                  // LLMì´ ìƒì„±í•œ ì œëª©
  components: ComponentConfig[];  // ì„ íƒëœ ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸ ëª©ë¡
  reactCode: string;              // ìƒì„±ëœ React ì½”ë“œ
  realTimeConfig: {
    enabled: boolean;
    interval: number;
  };
}

async function generateDashboard(
  request: DashboardGenerationRequest
): Promise<DashboardConfig> {
  // 1. LLM ìš”ì²­ ë¶„ì„
  const analysis = await analyzeLLMRequest(request.userRequest);

  // 2. í•„ìš”í•œ ë°ì´í„° ì†ŒìŠ¤ ì‹ë³„
  const dataSources = identifyDataSources(analysis);

  // 3. ì»´í¬ë„ŒíŠ¸ ì„ íƒ
  const components = dataSources.map(ds => ({
    type: selectChartComponent(ds.dataType, analysis.intent),
    dataKey: ds.key,
    width: calculateOptimalWidth(ds),
    height: calculateOptimalHeight(ds),
    props: generateChartProps(ds)
  }));

  // 4. React ì½”ë“œ ìƒì„±
  const reactCode = generateReactCode(components, analysis.title);

  return {
    title: analysis.title,
    components,
    reactCode,
    realTimeConfig: {
      enabled: true,
      interval: request.refreshInterval || 30000
    }
  };
}
```

---

## ğŸ“Š ì§€ì› ì°¨íŠ¸ íƒ€ì…

### 1. MetricCard (KPI ì¹´ë“œ)

```typescript
interface MetricCardProps {
  value: number;
  label: string;
  trend?: 'up' | 'down' | 'neutral';
  trendValue?: number;
  unit?: string;
}

const MetricCard = ({ value, label, trend, trendValue, unit }: MetricCardProps) => (
  <div className="metric-card">
    <h3>{label}</h3>
    <div className="value">{value}{unit}</div>
    {trend && (
      <div className={`trend ${trend}`}>
        {trend === 'up' ? 'â†‘' : 'â†“'} {trendValue}%
      </div>
    )}
  </div>
);
```

### 2. BarChart (ë§‰ëŒ€ ê·¸ë˜í”„)

```typescript
import { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer } from 'recharts';

const CustomBarChart = ({ data, xKey, yKey }: ChartProps) => (
  <ResponsiveContainer width="100%" height={300}>
    <BarChart data={data}>
      <XAxis dataKey={xKey} />
      <YAxis />
      <Tooltip />
      <Bar dataKey={yKey} fill="#3b82f6" />
    </BarChart>
  </ResponsiveContainer>
);
```

### 3. LineChart (ì„  ê·¸ë˜í”„)

```typescript
import { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from 'recharts';

const CustomLineChart = ({ data, xKey, yKey }: ChartProps) => (
  <ResponsiveContainer width="100%" height={300}>
    <LineChart data={data}>
      <XAxis dataKey={xKey} />
      <YAxis />
      <Tooltip />
      <Line type="monotone" dataKey={yKey} stroke="#3b82f6" strokeWidth={2} />
    </LineChart>
  </ResponsiveContainer>
);
```

### 4. GaugeChart (ê²Œì´ì§€)

```typescript
const GaugeChart = ({ value, max, label }: GaugeProps) => {
  const percentage = (value / max) * 100;
  const color = percentage >= 80 ? '#22c55e' : percentage >= 50 ? '#eab308' : '#ef4444';

  return (
    <div className="gauge-chart">
      <svg viewBox="0 0 200 100">
        <path d="M 20 80 A 80 80 0 0 1 180 80" fill="none" stroke="#e5e7eb" strokeWidth="20" />
        <path
          d={`M 20 80 A 80 80 0 ${percentage > 50 ? '1' : '0'} 1 ${calculateArcEnd(percentage)}`}
          fill="none"
          stroke={color}
          strokeWidth="20"
        />
      </svg>
      <div className="gauge-label">{label}: {value}/{max}</div>
    </div>
  );
};
```

---

## ğŸ”§ êµ¬í˜„ ê°€ì´ë“œ

### Data Visualization Service (8006) - ë‹¨ìˆœ ëŒ€ì‹œë³´ë“œ

**ì—­í• **: ë¯¸ë¦¬ ì •ì˜ëœ ì°¨íŠ¸ë¡œ ë°ì´í„° í‘œì‹œ (í¸ì§‘ ê°€ëŠ¥)

```typescript
// ë‹¨ìˆœ ë Œë”ë§ ë¡œì§
async function renderDashboard(dashboardId: string) {
  // 1. DBì—ì„œ ëŒ€ì‹œë³´ë“œ ì„¤ì • ë¡œë“œ
  const config = await loadDashboardConfig(dashboardId);

  // 2. PostgreSQL ë°ì´í„° ì§ì ‘ ì¡°íšŒ
  const data = await queryData(config.dataSources);

  // 3. ë¯¸ë¦¬ ì •ì˜ëœ ì°¨íŠ¸ ë Œë”ë§
  return <AutoGeneratedDashboard config={config} />;
}
```

### BI Service (8007) - AI ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±

**ì—­í• **: MCP ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ ì¡°ë¦½ + AI ì¸ì‚¬ì´íŠ¸ ìƒì„±

```python
# FastAPI ì—”ë“œí¬ì¸íŠ¸ (BI Service)

@app.post("/api/v2/bi/generate-insight")
async def generate_insight(request: InsightRequest):
    # 1. LLM ìš”ì²­ ë¶„ì„
    analysis = await analyze_request(request.user_request)

    # 2. Judgment Service í˜¸ì¶œ (ë°ì´í„° ê¸°ë°˜ íŒë‹¨)
    judgment_result = await call_judgment_service(analysis)

    # 3. React ì»´í¬ë„ŒíŠ¸ ìë™ ìƒì„±
    dashboard_config = await generate_dashboard(
        userRequest=request.user_request,
        judgmentData=judgment_result
    )

    # 4. ë¹„ì¦ˆë‹ˆìŠ¤ ê¶Œì¥ì‚¬í•­ ìƒì„± (RAG ì—”ì§„)
    recommendations = await generate_recommendations(
        judgmentResult=judgment_result,
        similarCases=await search_similar_cases(judgment_result)
    )

    return {
        "dashboard": dashboard_config,
        "insights": recommendations,
        "judgment": judgment_result
    }
```

---

## ğŸš€ ì‚¬ìš© ì˜ˆì‹œ

### 1. ì‚¬ìš©ì ìš”ì²­

```
"ì§€ë‚œ ì£¼ ì›Œí¬í”Œë¡œìš°ë³„ ì„±ê³µë¥ ì„ ë³´ì—¬ì¤˜"
```

### 2. LLM ë¶„ì„ ê²°ê³¼

```json
{
  "title": "ì›Œí¬í”Œë¡œìš°ë³„ ì„±ê³µë¥  (ì§€ë‚œ ì£¼)",
  "dataSources": [
    {
      "type": "workflow_executions",
      "timeRange": "last_7_days",
      "groupBy": "workflow_id",
      "metric": "success_rate"
    }
  ],
  "intent": "comparison",
  "chartType": "BarChart"
}
```

### 3. ìƒì„±ëœ ëŒ€ì‹œë³´ë“œ ì„¤ì •

```json
{
  "title": "ì›Œí¬í”Œë¡œìš°ë³„ ì„±ê³µë¥  (ì§€ë‚œ ì£¼)",
  "components": [
    {
      "type": "BarChart",
      "dataKey": "workflow_success_rate",
      "width": 12,
      "height": 6,
      "props": {
        "xKey": "workflow_name",
        "yKey": "success_rate",
        "yAxisLabel": "ì„±ê³µë¥  (%)"
      }
    }
  ],
  "realTimeConfig": {
    "enabled": true,
    "interval": 30000
  }
}
```

### 4. ìƒì„±ëœ React ì½”ë“œ

```typescript
export const WorkflowSuccessRateDashboard = () => {
  const { data, loading } = useRealTimeData({
    dataSource: 'workflow_success_rate',
    refreshInterval: 30000
  });

  if (loading) return <div>Loading...</div>;

  return (
    <div className="dashboard-container">
      <h1 className="text-2xl font-bold mb-6">ì›Œí¬í”Œë¡œìš°ë³„ ì„±ê³µë¥  (ì§€ë‚œ ì£¼)</h1>
      <div className="grid grid-cols-12 gap-4">
        <div className="col-span-12 h-96">
          <BarChart
            data={data}
            xKey="workflow_name"
            yKey="success_rate"
            yAxisLabel="ì„±ê³µë¥  (%)"
          />
        </div>
      </div>
    </div>
  );
};
```

---

## ğŸ’¡ ì£¼ì˜ì‚¬í•­

1. **MCP ì»´í¬ë„ŒíŠ¸ ì¡°ë¦½**: React ì½”ë“œë¥¼ ì™„ì „íˆ ìƒì„±í•˜ëŠ” ëŒ€ì‹ , **ì‚¬ì „ ì œì‘ëœ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¡°ë¦½**í•˜ëŠ” ë°©ì‹ ê¶Œì¥
2. **ì‹¤ì‹œê°„ ë°ì´í„°**: WebSocket ì—°ê²°ë¡œ 30ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
3. **ì°¨íŠ¸ íƒ€ì… ì„ íƒ**: LLMì´ ë°ì´í„° íƒ€ì…ê³¼ ì˜ë„ë¥¼ ë¶„ì„í•˜ì—¬ ìµœì  ì°¨íŠ¸ ìë™ ì„ íƒ
4. **ë“œë˜ê·¸ì•¤ë“œë¡­**: Data Visualization ServiceëŠ” ì°¨íŠ¸ ë°°ì¹˜ í¸ì§‘ ê¸°ëŠ¥ ì œê³µ

---

**ê´€ë ¨ ë¬¸ì„œ**:
- [CLAUDE.md](../../CLAUDE.md) - ì„¹ì…˜ 2.2 (3-Tier Frontend ì „ëµ)
- [docs/services/bi_service.md](../services/bi_service.md) - BI Service ìƒì„¸ ì„¤ê³„
- [docs/services/data_visualization_service.md](../services/data_visualization_service.md) - Data Visualization Service
