# prompt-guide.md

이 문서는 Claude 판단 엔진과 MCP 기반 자동화 시스템이 사용하는 Prompt 설계 가이드를 제공합니다. 주요 목적은 다음과 같습니다:

- 판단 품질 향상
- 일관된 대화형 인터페이스 유지
- MCP 연동 시 오작동 최소화

---

## 1. Prompt 유형 구분

| Prompt 유형 | 설명 | 예시 |
|-------------|------|------|
| 사용자 질의형 | 자연어 질문 입력 | "현재 온도는 몇 도야?" |
| 시스템 명령형 | MCP에서 내부 명령 전달 | `mcp://sensor.read("temp")` |
| 판단 유도형 | Claude가 스스로 판단하도록 유도 | "다음 조건을 보고 작업자 호출 여부를 판단해줘." |
| 프레임 기반형 | PRP 또는 DSL 기반 템플릿 삽입 | `plan: {...}, reason: {...}, prompt: {...}` |

---

## 2. Prompt 작성 원칙

1. **역할 명시**: Claude가 어떤 역할인지 서두에 명시
   - 예: "너는 실시간 생산품질 관리 에이전트야"

2. **입력 구분**: 입력 데이터는 항상 코드 블록 또는 리스트로 구분

3. **출력 명확화**: 어떤 형식(json, text 등)으로 응답할지 요구

4. **판단근거 유도**: reasoning 단계 포함 시 "왜 그렇게 판단했는지 설명해줘" 포함

5. **예외 대응 포함**: "판단 불가능하면 이유를 말해줘" 또는 "모르면 'UNKNOWN'으로 응답해줘"

---

## 3. MCP 연동 Prompt 예시

### 3.1 센서 수집 데이터 판단 요청
```text
너는 생산 공장의 온습도 판단 에이전트야. 다음 데이터를 보고 작업자 호출이 필요한지 판단해줘.

```
{
  "temp": 88,
  "humidity": 18
}

조건: 온도 > 85 AND 습도 < 20이면 호출
응답은 JSON 형식으로, 결과와 설명을 함께 줘
```

### 3.2 Supabase에서 특정 데이터 조회
```text
너는 supabase에 연결된 데이터 분석가야. 아래 쿼리를 실행해서 결과만 보여줘.

쿼리: `SELECT * FROM temperature_logs WHERE temp > 90 ORDER BY timestamp DESC LIMIT 5;`

응답 형식: markdown 테이블
```

---

## 4. 오류 방지 팁
- **조건문은 항상 명시적으로**: "~이상" 보다는 "~ 이상이면" 같은 구문으로
- **출력 형식 명시 필수**: JSON, 테이블, 마크다운 등
- **입력 값 누락 시 응답 규칙 지정**: "데이터가 없으면 'NO_DATA'로 응답해줘"

---

## 5. 추천 프롬프트 템플릿

### 판단 에이전트용
```text
역할: ~한 판단을 수행하는 LLM 에이전트야.
목적: ~ 기준에 따라 판단하고 사용자에게 설명을 제공
입력: { JSON or 리스트 }
조건: ~일 경우 A, 아니면 B
응답: JSON 형태로 { result, explanation } 반환
```

### Supabase 쿼리 요청용
```text
역할: supabase에 쿼리를 실행하고 요약하는 AI
목적: 쿼리 실행 후 결과 요약 또는 필터링
입력: 쿼리문 (SQL)
응답: 마크다운 표 또는 bullet list
```

---

(이 문서는 `prp-example.md` 및 `initial.md`의 기준을 따름)

