-- ========================================
-- 016: 최근 센서 데이터 시드 (2025년 12월)
-- 목적: 온도 변화 추이 차트가 데이터 없음 오류를 방지하기 위해
--       최근 7일간의 센서 데이터 생성
-- ========================================

-- 기존 최근 데이터 삭제 (중복 방지)
DELETE FROM sensor_log WHERE recorded_at >= '2025-12-01';

-- ========================================
-- 1. 살균기 온도 센서 로그 (최근 7일)
-- ========================================
INSERT INTO sensor_log (equip_cd, param_cd, batch_lot_no, recorded_at, value, is_alarm, alarm_type) VALUES
-- 12월 1일 (일)
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 09:00:00', 85.2, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 09:30:00', 85.5, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 10:00:00', 85.8, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 10:30:00', 86.0, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 11:00:00', 85.7, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 14:00:00', 85.3, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 14:30:00', 85.6, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251201-001', '2025-12-01 15:00:00', 85.9, 0, NULL),

-- 12월 2일 (월)
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 09:00:00', 84.8, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 09:30:00', 85.1, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 10:00:00', 85.4, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 10:30:00', 85.7, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 11:00:00', 86.0, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 14:00:00', 85.5, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 14:30:00', 85.8, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251202-001', '2025-12-02 15:00:00', 86.1, 0, NULL),

-- 12월 3일 (화)
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 09:00:00', 85.0, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 09:30:00', 85.3, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 10:00:00', 85.6, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 10:30:00', 85.9, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 11:00:00', 86.2, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 14:00:00', 85.4, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 14:30:00', 85.7, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251203-001', '2025-12-03 15:00:00', 86.0, 0, NULL),

-- 12월 4일 (수)
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 09:00:00', 84.5, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 09:30:00', 84.9, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 10:00:00', 85.2, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 10:30:00', 85.5, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 11:00:00', 85.8, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 14:00:00', 85.1, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 14:30:00', 85.4, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251204-001', '2025-12-04 15:00:00', 85.7, 0, NULL),

-- 12월 5일 (목, 오늘) - 온도 약간 상승 추세
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251205-001', '2025-12-05 09:00:00', 85.5, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251205-001', '2025-12-05 09:30:00', 85.9, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251205-001', '2025-12-05 10:00:00', 86.3, 0, NULL),
('EQ-PAST-01', 'PARAM-PAST-TEMP', 'BATCH-251205-001', '2025-12-05 10:30:00', 86.5, 0, NULL);

-- ========================================
-- 2. 냉각기 온도 센서 로그 (최근 7일)
-- ========================================
INSERT INTO sensor_log (equip_cd, param_cd, batch_lot_no, recorded_at, value, is_alarm, alarm_type) VALUES
-- 12월 1일
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251201-001', '2025-12-01 11:30:00', 4.2, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251201-001', '2025-12-01 12:00:00', 4.0, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251201-001', '2025-12-01 12:30:00', 3.8, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251201-001', '2025-12-01 15:30:00', 4.1, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251201-001', '2025-12-01 16:00:00', 3.9, 0, NULL),

-- 12월 2일
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251202-001', '2025-12-02 11:30:00', 4.3, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251202-001', '2025-12-02 12:00:00', 4.1, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251202-001', '2025-12-02 12:30:00', 3.9, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251202-001', '2025-12-02 15:30:00', 4.0, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251202-001', '2025-12-02 16:00:00', 3.8, 0, NULL),

-- 12월 3일
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251203-001', '2025-12-03 11:30:00', 4.4, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251203-001', '2025-12-03 12:00:00', 4.2, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251203-001', '2025-12-03 12:30:00', 4.0, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251203-001', '2025-12-03 15:30:00', 4.1, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251203-001', '2025-12-03 16:00:00', 3.9, 0, NULL),

-- 12월 4일
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251204-001', '2025-12-04 11:30:00', 4.5, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251204-001', '2025-12-04 12:00:00', 4.3, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251204-001', '2025-12-04 12:30:00', 4.1, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251204-001', '2025-12-04 15:30:00', 4.2, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251204-001', '2025-12-04 16:00:00', 4.0, 0, NULL),

-- 12월 5일 (오늘)
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251205-001', '2025-12-05 11:30:00', 4.6, 0, NULL),
('EQ-COOL-01', 'PARAM-COOL-TEMP', 'BATCH-251205-001', '2025-12-05 12:00:00', 4.4, 0, NULL);

-- ========================================
-- 3. 믹싱 온도 센서 로그 (최근 7일)
-- ========================================
INSERT INTO sensor_log (equip_cd, param_cd, batch_lot_no, recorded_at, value, is_alarm, alarm_type) VALUES
-- 12월 1일
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251201-001', '2025-12-01 08:00:00', 22.5, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251201-001', '2025-12-01 09:00:00', 23.1, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251201-001', '2025-12-01 10:00:00', 23.8, 0, NULL),

-- 12월 2일
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251202-001', '2025-12-02 08:00:00', 22.8, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251202-001', '2025-12-02 09:00:00', 23.3, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251202-001', '2025-12-02 10:00:00', 24.0, 0, NULL),

-- 12월 3일
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251203-001', '2025-12-03 08:00:00', 22.6, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251203-001', '2025-12-03 09:00:00', 23.2, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251203-001', '2025-12-03 10:00:00', 23.9, 0, NULL),

-- 12월 4일
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251204-001', '2025-12-04 08:00:00', 22.4, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251204-001', '2025-12-04 09:00:00', 23.0, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251204-001', '2025-12-04 10:00:00', 23.7, 0, NULL),

-- 12월 5일 (오늘)
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251205-001', '2025-12-05 08:00:00', 22.7, 0, NULL),
('EQ-MIX-01', 'PARAM-MIX-TEMP', 'BATCH-251205-001', '2025-12-05 09:00:00', 23.4, 0, NULL);

-- ========================================
-- 4. 일별 평균 온도 데이터 뷰 (편의용)
-- ========================================
-- 뷰 삭제 후 재생성 (존재하면)
DROP VIEW IF EXISTS v_daily_avg_temperature;

CREATE VIEW v_daily_avg_temperature AS
SELECT
    DATE(recorded_at) as date,
    equip_cd,
    param_cd,
    ROUND(AVG(value), 2) as avg_temp,
    ROUND(MIN(value), 2) as min_temp,
    ROUND(MAX(value), 2) as max_temp,
    COUNT(*) as reading_count
FROM sensor_log
WHERE param_cd LIKE '%TEMP%'
GROUP BY DATE(recorded_at), equip_cd, param_cd
ORDER BY date DESC;
